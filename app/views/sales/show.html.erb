<!-- SEO -->
<% content_for :meta_title, "A vendre sur #{@sale.city}, #{@sale.description}  " %>

<% content_for :meta_description, "Nouveau bien à vendre sur #{@sale.city}, #{@sale.bedroom} chambres, #{@sale.description}"%>
<%= content_for(:facebook_meta_title) do %>
	<%= "A vendre sur #{@sale.city}, #{@sale.description}" %>
<% end %>
<%= content_for(:facebook_meta_description) do %>
	<%= "Nouveau bien à vendre sur #{@sale.city}, #{@sale.bedroom} chambres, #{@sale.description}" %>
<% end %>

<!-- FIN SEO -->

<div class="container">
	<div class="mt-20"></div>
	<div class="row">
		<div class="col-md-10 hidden-xs">
			<h1 class="title"><%= @sale.title %></h1>
			<h3><%= @sale.city %></h3>
		</div>
		<div class="hidden-md hidden-sm hidden-lg col-xs-12">
			<h3 style="color:#006666; font-size:18px!important;"><%=@sale.city %></h3>
		</div>
		<div class="col-md-2 hidden-xs hidden-md hidden-sm">
			<div class="label-sale text-center">
				<% if @sale.phase == "A VENDRE" %>
					A VENDRE
				<% elsif @sale.phase == "COMPROMIS" %>
					COMPROMIS
				<% elsif @sale.phase == "VENDU" %>
					VENDU
				<% else %>
					A VENDRE
				<% end %>
			</div>	
		</div>
	</div>
	<div class="mb-30"></div>
	<div class="row">
		<div class="col-md-2 hidden-xs hidden-md hidden-sm">
			<p><%= pluralize(@sale.bedroom, "Chambre")%></p>
		</div>
		<div class="hidden-lg hidden-md col-xs-12">
			<p><%= @sale.price%> € - <%= pluralize(@sale.bedroom, "Chambre") %></p>
		</div>
		<div class="col-md-2 hidden-xs  hidden-sm">
			<p class="bold">
				<%= @sale.price %> € 
			</p>
		</div>
	</div>
	<div class="mb-30"></div>
	<div class="row">
		<div class="col-md-4 col-xs-12 col-sm-4 col-lg-4">
			<% if @sale.photos.present? %>
				<div class="col-md-12">
					<!-- Carousel -->
      				<div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
        				<!-- Wrapper for slides -->
        				<div class="carousel-inner" role="listbox">
          					<div class="item active">
            					<%= cl_image_tag @sale.photos.first.path, width: 470, height: 350, :quality=>"auto:eco", crop: :fill %>
            					<div class="open-full-screen-carousel"></div>
          					</div>
          					<% @sale.photos[1...@sale.photos.size].each do |photo| %>
          	 					<div class="item">
          							<%= cl_image_tag photo.path, width: 470, height: 350, :quality=>"auto:eco", crop: :fill %>
          							<div class="open-full-screen-carousel"></div>
            					</div>
          					<% end %>
        				</div>
       					 <!-- Controls -->
        				<a class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev">
          					<span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
          					<span class="sr-only">Previous</span>
        				</a>
        				<a class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next">
          					<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
          					<span class="sr-only">Next</span>
        				</a>
					</div>
				</div>
			<% end %>
		</div>

		<div class="col-md-6 hidden-xs justify">
			<h4>Description</h4>
			<p style="text-align:justify"><%= @sale.description %></p>
		</div>
		<div class="col-xs-12 hidden-lg hidden-md hidden-sm">
			<h4 style="border:1px solid #999999; text-transform:uppercase; color:#006666; padding:10px;">Description</h4>
			<p style="text-align:justify"><%= @sale.description %></p>
		</div>
	</div>
	<% if @sale.seller_buyer.present? %>
		<div class="mt-30">
			<% if @sale.seller_buyer == "Commission Charge ACHETEUR" %>
						<p>Honoraires inclus dans le prix Charge Acheteur d'un montant de <%= @sale.fees %> €</p>
			<% else %>
						<p>Honoraires inclus dans le prix </p>
			<% end %>
		</div>
	<% end %>
	<div class="mb-50"></div>
	<div class="horizontal-line"></div>
	
	<div class="mb-50"></div>
	
	<%= render 'sales/shared/dpe' %>	

	<div class="mb-50"></div>
	<div class="horizontal-line"></div>
	
	<div class="mb-50"></div>
	
	<div class="row">
			
		
			
		
		<div class="col-md-6 hidden-xs">
			<h3>LES INFOS ESSENTIELLES</h3>
		</div>
		<div class="col-xs-12 hidden-lg hidden-md hidden-sm">
			<h4 style="border:1px solid #999999; text-transform:uppercase; color:#006666; padding:10px;">Les infos essentielles</h4>
		</div>
	</div>
	<div class="row">
		<div class="col-md-6">
			<p>Prix: <%= @sale.price %>€</p>
			<p><%= pluralize(@sale.bedroom, "Chambre") %></p>
			<p>Taxe Foncière: <%= @sale.taxe %> €</p>
			<p>Chauffage: <%= @sale.heating %></p>
			<p>Exposition: <%= @sale.exposition %></p>
		</div>
		<div class="col-md-6 hidden-xs hidden-sm">
			<%= render 'sales/shared/conseiller' %>
		</div>
	</div>
	<div class="mb-50"></div>
</div>
<div class="container">
	<!-- <div class="row">
		<div class="col-md-12">
			<div id="map" class="mb-30 mt-30" style="width: 100%; height: 600px;"></div>
			<p>La géolocalisation est approximative</p>
		</div>
	</div>	 -->
	<div class="col-md-12">
		<div class="horizontal-line"></div>
	</div>
	<div class="col-xs-6 col-xs-offset-3 hidden-md hidden-lg hidden-sm  ">
		<%= render 'sales/shared/photo_conseiller' %>
	</div>
	<div class="col-xs-12 hidden-md hidden-lg hidden-sm text-center  ">
		<%= render 'sales/shared/conseiller' %>
	</div>
	<div class="col-sm-6 hidden-md hidden-lg hidden-xs ">
		<%= render 'sales/shared/photo_conseiller' %>
	</div>
	<div class="col-sm-6 hidden-md hidden-lg hidden-xs  ">
		<%= render 'sales/shared/conseiller' %>
	</div>
</div>
	<div class="mb-50"></div>
</div>
<!-- <div class="container-fluid">
	<div class="row">
		<div class="photo-full-width" style="background-image: linear-gradient(135deg, rgba(150,109,105,0.2), rgba(150,109,105,0.4)), url('<%= cl_image_path @sale.photos.first.path %>');">
		</div>
	</div>
</div> -->

<% if current_user.try(:admin?) %>
	<%= simple_form_for [@sale, @link_partner] do |f| %>
	    <%= f.input :link %>
	    <%= f.association :partner %>
	    <%= f.submit %>
	<% end %>
<% end %>
<div class="container">
	<div class="row">
		<% if @sale.link_partners.count >=4 %>
			<div class="col-md-12 hidden-xs">
				<h3>NOS PRINCIPAUX PARTENAIRES</h3>
				<div class="mb-50"></div>
			</div>
			<% @sale.link_partners.each do |link_partner| %>
				<div class="col-md-3 hidden-xs">
			 		<!--<li><%= link_partner.partner.name%></li> -->
			 		<%= link_to "#{link_partner.link}" do  %>
			    		<%= cl_image_tag link_partner.partner.photo.path, width: 136, height: 67%>
					<% end %>
			 		<!-- <li><%= link_partner.link %></li> -->
			 		<div class="mb-50"></div>
			 	</div>
			<% end %>
		<% end %>

	</div>

</div>



<!-- FULL SCREEN CAROUSEL -->
<div id="full-screen-display" class="hidden">
	<div id="full-carousel-example-generic" class="carousel slide hidden" data-ride="carousel">
    <!-- Wrapper for slides -->
		<div class="carousel-inner" role="listbox">
			<div class="item active">
				<%= cl_image_tag @sale.photos.first.path, width: 800, height: 600, crop: :fill %>
			</div>
			<% @sale.photos[1...@sale.photos.size].each do |photo| %>
				<div class="item">
					<%= cl_image_tag photo.path, width: 800, height: 600, crop: :fill %>
				</div>
      		<% end %>
      	</div>



   
    	<!-- Controls -->
    	<a class="left carousel-control" href="#full-carousel-example-generic" role="button" data-slide="prev">
    		<span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
      		<span class="sr-only">Previous</span>
    	</a>
    	<a class="right carousel-control" href="#full-carousel-example-generic" role="button" data-slide="next">
      		<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
      		<span class="sr-only">Next</span>
    	</a>
    	<div id="close-full-screen-carousel"><i class="fa fa-times" aria-hidden="true"></i></div>
  	</div>
</div>
<div id="full-wrapper-for-full-screen-carousel" class="hidden"></div>

<% content_for(:after_js) do %>
  <%= javascript_tag do %>
    $(document).ready(function() {
		circle = [{lng: <%= @sale.longitude %>, lat: <%= @sale.latitude %>, radius: 200}]
     	circle_options = { strokeColor:"#FECC1F",strokeOpacity: 1, strokeWeight: 3, fillColor: 'transparent' }

      	var handler = Gmaps.build('Google');
      	handler.buildMap({ internal: { id: 'map' } }, function() {

      
        markers = handler.addMarkers(<%= raw @markers.to_json %>);
        handler.bounds.extendWith(markers);
        
        handler.fitMapToBounds();
        if (markers.length == 0) {
          handler.getMap().setZoom(2);
        } else if (markers.length == 1) {
          handler.getMap().setZoom(14);
        }
      });
    });
  <% end %>
<% end %>

